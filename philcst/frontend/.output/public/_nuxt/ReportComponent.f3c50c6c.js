import{_ as Q}from"./DepartmentSelector.04ab34fc.js";import{J as U,r as N,q as V,c as o,_ as j,K as B,o as s,b as S,w as F,a as e,F as $,D as k,t as u,E as x,B as L,d as D,p as Y,f as q,G as z,v as R,L as P,x as c,z as T,C as E,A as G,H}from"./entry.b4168997.js";import{u as O}from"./useAPI.05844c13.js";const M=U({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(n,{slots:l,attrs:d}){const t=N(!1);return V(()=>{t.value=!0}),a=>{var _;if(t.value)return(_=l.default)==null?void 0:_.call(l);const h=l.fallback||l.placeholder;if(h)return h();const f=a.fallback||a.placeholder||"",g=a.fallbackTag||a.placeholderTag||"span";return o(g,d,f)}}});const J={props:{reportData:{type:Object,default:()=>{}},currentAcademicYear:{type:Object,default:()=>{}}},data:()=>({isExporting:!1,exportFilename:"my-custom-file.pdf",pdfOptions:{margin:15,image:{type:"jpeg",quality:1},html2canvas:{scale:3},jsPDF:{unit:"mm",format:"a4",orientation:"p"}},exportableRef:"exportableArea"}),methods:{handleExport(){this.isExporting=!0,this.toggleElements(!0),setTimeout(()=>{window.print()},800),setTimeout(()=>{this.isExporting=!1,this.toggleElements(!1)},5e3)},toggleElements(n){const l=document.querySelector("#sidebar-component");l&&(n?l.classList.add("sidebar--hidden"):l.classList.remove("sidebar--hidden"));const d=document.querySelector(".report-page__title");d&&(n?d.classList.add("report-page__title--hidden"):d.classList.remove("report-page__title--hidden"));const t=document.querySelector("#faculty-report-component");t&&(n?t.classList.add("faculty-report--exporting"):t.classList.remove("faculty-report--exporting"))}}},A=n=>(Y("data-v-fdf720ab"),n=n(),q(),n),K={class:"stack-container criteria-summary"},W={class:"criteria-summary__export-area"},X={class:"criteria-summary__table-container"},Z={class:"table table-bordered table-striped"},ee=A(()=>e("thead",null,[e("tr",null,[e("th",{class:"text-center"}," Criteria "),e("th",{class:"text-center"}," Average Point ")])],-1)),te={class:"text-center"},ae={key:0},se=A(()=>e("td",null," Additional Points as asset to the school ",-1)),oe={class:"text-center"},ne=A(()=>e("td",null," Total Points Earned: ",-1)),re={class:"text-center"},le={class:"criteria-summary__export d-flex align-items-center justify-content-center"},ce={key:0,class:"criteria-summary__comments"},ie={key:0};function de(n,l,d,t,a,h){const f=B("Vue3SimpleHtml2pdf"),g=M;return s(),o("div",K,[S(g,null,{default:F(()=>[S(f,{ref:n.exportableRef,options:n.pdfOptions,filename:n.exportFilename},{default:F(()=>[e("div",W,[e("div",X,[e("table",Z,[ee,e("tbody",null,[(s(!0),o($,null,k(d.reportData.criterias,(_,y)=>(s(),o("tr",{key:y},[e("td",null,u(_.criteria.name),1),e("td",te,u(_.average),1)]))),128)),d.reportData.slug==="peer-to-peer"?(s(),o("tr",ae,[se,e("td",oe,u(d.reportData.peerPoints),1)])):x("",!0),e("tr",null,[ne,e("td",re,u(d.reportData.total_points),1)])])])])])]),_:1},8,["options","filename"])]),_:1}),e("div",le,[n.isExporting?x("",!0):(s(),o("button",{key:0,onClick:l[0]||(l[0]=(..._)=>h.handleExport&&h.handleExport(..._)),class:L(["criteria-summary__export-button",n.isExporting&&"criteria-summary__export-button--disabled"])},u(n.isExporting?"Printing...":"Print"),3))]),d.reportData.comments.length?(s(),o("div",ce,[e("h2",null," Comments "+u(d.reportData.comments.length),1),(s(!0),o($,null,k(d.reportData.comments,(_,y)=>(s(),o("div",{class:"comment-container",key:y},[e("div",null,[D(u(y+1)+". "+u(_.evaluator.name)+" ",1),_.evaluator.department?(s(),o("small",ie," - ("+u(_.evaluator.department.department)+")",1)):x("",!0)]),e("p",null," --- "+u(_.comments),1)]))),128))])):x("",!0)])}const ue=j(J,[["render",de],["__scopeId","data-v-fdf720ab"]]);const w=n=>(Y("data-v-1921eb9b"),n=n(),q(),n),_e={class:"faculty-report",id:"faculty-report-component"},pe={key:0},me={class:"info-style"},he=w(()=>e("b",null,"Name:",-1)),fe={class:"info-style"},ye=w(()=>e("b",null,"Department",-1)),ve={class:"info-style mb-3"},be=w(()=>e("b",null,"Role",-1)),ge={class:"stack-container faculty-report__content"},xe={class:"faculty-report__header"},we={class:"d-flex justify-content-between"},$e={class:"w-100 px-2"},ke=w(()=>e("label",{for:"",class:"fw-bold"}," Questionnaire Type: ",-1)),Ce=["value"],Ie={class:"w-100 px-2"},De=w(()=>e("label",{for:"",class:"fw-bold"}," Academic Year: ",-1)),Se=["value"],Te={key:0},Re={key:1},Ee=w(()=>e("p",null," No report data ",-1)),Ve=[Ee],je={key:1,class:"spinner-border text-primary",role:"status"},Ye=w(()=>e("span",{class:"visually-hidden"},"Loading...",-1)),qe=[Ye],Ae={__name:"FacultyReport",props:{evaluatee:{type:Object,default:()=>{}}},setup(n){const l=n,d=O(),{getCurrentUser:t}=z(),a=R({loaded:!1,academicYears:[],academicYearId:"",questionnaires:[],questionnaireId:"",reportData:{}}),h=P(()=>a.academicYears.find(m=>m.id===a.academicYearId));V(async()=>{await f(),a.loaded=!0});async function f(){await g(),await _(),await I()}async function g(){const i=(await d({url:"admin/academic-years",method:"GET",headers:{"Content-Type":"application/json"}})).data.records;a.academicYears=i,a.academicYearId=i[0].id}async function _(){const i=(await d({url:"/admin/questionnaires",method:"GET",headers:{"Content-Type":"application/json"}})).data.records,p=y(i);a.questionnaires=p,a.questionnaireId=p[0].id}function y(m){const i=t(),p=[];return m.forEach(v=>{(i.role.role==="admin"||["student-to-faculty","dean-to-faculty","peer-to-peer"].includes(v.slug))&&p.push(v)}),p}async function I(){a.loaded=!1;const m={academic_year_id:a.academicYearId,questionnaire_id:a.questionnaireId,evaluatee_id:l.evaluatee.id},p=(await d({url:"/admin/reports/get_evaluation_report",method:"POST",headers:{"Content-Type":"application/json"},data:m})).data.record;a.reportData=p,a.loaded=!0}return(m,i)=>{var v;const p=ue;return s(),o("div",_e,[c(a).loaded?(s(),o("div",pe,[e("p",me,[he,D(" "+u(l.evaluatee.name),1)]),e("p",fe,[ye,D(": "+u(l.evaluatee.department.department),1)]),e("p",ve,[be,D(": "+u(l.evaluatee.role.role.toUpperCase()),1)]),e("div",ge,[e("div",xe,[e("div",we,[e("div",$e,[ke,T(e("select",{name:"role","onUpdate:modelValue":i[0]||(i[0]=r=>c(a).questionnaireId=r),onChange:I,class:"w-100 mx-0"},[(s(!0),o($,null,k(c(a).questionnaires,(r,b)=>(s(),o("option",{key:b,value:r.id},u(r.name),9,Ce))),128))],544),[[E,c(a).questionnaireId]])]),e("div",Ie,[De,T(e("select",{name:"role","onUpdate:modelValue":i[1]||(i[1]=r=>c(a).academicYearId=r),onChange:I,class:"w-100 mx-0"},[(s(!0),o($,null,k(c(a).academicYears,(r,b)=>(s(),o("option",{key:b,value:r.id},u(`${r.year} - ${r.semester} semester`),9,Se))),128))],544),[[E,c(a).academicYearId]])])])]),(v=c(a).reportData)!=null&&v.criterias.length?(s(),o("div",Te,[S(p,{reportData:c(a).reportData,currentAcademicYear:c(h)},null,8,["reportData","currentAcademicYear"])])):(s(),o("div",Re,Ve))])])):(s(),o("div",je,qe))])}}},Fe=j(Ae,[["__scopeId","data-v-1921eb9b"]]);const C=n=>(Y("data-v-3c61221a"),n=n(),q(),n),Le={class:"evaluation-component bgCard"},Pe={key:0},Oe={key:0,class:"evaluation-component__header"},Qe={class:"stack-container"},Ue={class:"d-flex justify-content-between"},Ne={class:"d-flex justify-content-between"},Be={class:"w-100 px-2"},ze=C(()=>e("label",{for:""}," Select role ",-1)),Ge=C(()=>e("option",{value:"",selected:""}," All Roles ",-1)),He=["value"],Me={class:"w-100 px-2"},Je=C(()=>e("label",null,"Search",-1)),Ke={class:"d-flex align-items-center justify-content-between"},We={key:1,class:"evaluation-component__body"},Xe={class:"table-container"},Ze={key:0,class:"table position-relative"},et=C(()=>e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col",class:"text-align-left"},"Name "),e("th",{scope:"col"},"Department"),e("th",{scope:"col"},"Role"),e("th",{scope:"col"},"Action")])],-1)),tt={scope:"row"},at=["onClick"],st={key:1},ot=C(()=>e("p",null," No record found. ",-1)),nt=[ot],rt={key:1,class:"spinner-border text-primary",role:"status"},lt=C(()=>e("span",{class:"visually-hidden"},"Loading...",-1)),ct=[lt],it={__name:"ReportComponent",props:{user:{type:Object,default:()=>{}},questionnaireType:{type:String,default:""}},setup(n){const l=n,d=O(),t=R({evaluatees:[],loaded:!1,departmentId:"",departments:[],roles:[{label:"Faculty",value:"faculty"},{label:"Dean",value:"dean"}],selectedRole:"",selectedAcademicYear:"",isViewing:!1,searchQuery:""});P(()=>!!(l.user&&l.user.role.role==="admin"));async function a(){const i={role:l.user.role.role,department_id:t.departmentId,evaluatee_name:t.searchQuery,evaluatee_role:t.selectedRole},p=await d({url:"admin/reports/fetch_faculties",method:"POST",headers:{"Content-Type":"application/json"},data:i});t.evaluatedFaculties=p.data.evaluated_faculties,t.evaluatees=p.data.records}async function h(){const m=await d({url:"departments",method:"GET",headers:{"Content-Type":"application/json"}});t.departments=m.data.records}async function f(){t.loaded=!1,await a(),t.loaded=!0}async function g(){await _(),await h(),await a()}async function _(){l.user.role.role!=="admin"&&(t.departmentId=l.user.department_id)}V(async()=>{await g(),t.loaded=!0});const y=R({evaluatee:{}});function I(m){y.evaluatee=m,t.isViewing=!0}return(m,i)=>{const p=Q,v=Fe;return s(),o("div",Le,[c(t).loaded?(s(),o("div",Pe,[c(t).isViewing?x("",!0):(s(),o("div",Oe,[e("div",Qe,[e("div",Ue,[S(p,{modelValue:c(t).departmentId,"onUpdate:modelValue":i[0]||(i[0]=r=>c(t).departmentId=r),onValueChanged:f,disabled:l.user.role.role!=="admin"},null,8,["modelValue","disabled"])]),e("div",Ne,[e("div",Be,[ze,T(e("select",{name:"role","onUpdate:modelValue":i[1]||(i[1]=r=>c(t).selectedRole=r),onChange:f,class:"w-100 mx-0"},[Ge,(s(!0),o($,null,k(c(t).roles,(r,b)=>(s(),o("option",{key:b,value:r.value},u(r.label),9,He))),128))],544),[[E,c(t).selectedRole]])]),e("div",Me,[Je,e("div",Ke,[T(e("input",{type:"text",name:"seachQuery","onUpdate:modelValue":i[2]||(i[2]=r=>c(t).searchQuery=r),placeholder:"Search instructor or dean",class:"mx-0 w-100"},null,512),[[G,c(t).searchQuery]])])])]),e("div",{class:"d-flex justify-content-end"},[e("button",{onClick:f,class:"cstm-button mx-2 px-4"}," Search ")])])])),c(t).isViewing?x("",!0):(s(),o("div",We,[e("div",Xe,[c(t).evaluatees.length?(s(),o("table",Ze,[et,e("tbody",null,[(s(!0),o($,null,k(c(t).evaluatees,(r,b)=>(s(),o("tr",{key:b},[e("th",tt,u(b+1),1),e("td",null,u(r.name),1),e("td",null,u(r.department.department),1),e("td",null,u(r.role.role.toUpperCase()),1),e("td",null,[e("button",{class:L(["cstm-button m-1","tdButton"]),onClick:dt=>I(r)}," View Report ",8,at)])]))),128))])])):(s(),o("div",st,nt))])])),c(t).isViewing?(s(),H(v,{key:2,evaluatee:c(y).evaluatee},null,8,["evaluatee"])):x("",!0)])):(s(),o("div",rt,ct))])}}},mt=j(it,[["__scopeId","data-v-3c61221a"]]);export{mt as _};
